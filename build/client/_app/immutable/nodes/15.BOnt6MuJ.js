import"../chunks/DsnmJJEf.js";import"../chunks/i9DHmAX1.js";import{o as ha}from"../chunks/BQQlMUYl.js";import{p as ga,m as h,l as ya,a as wa,f as E,i as xa,g as a,b as S,c as Aa,e as s,d as i,s as v,r,t as D,u as l,h as ka}from"../chunks/MgvKJ5Oe.js";import{s as g}from"../chunks/tNEdk8z3.js";import{i as T}from"../chunks/uYRH7WDe.js";import{e as Sa}from"../chunks/D3LgcHxc.js";import{r as y,a as q,s as qa}from"../chunks/STPvjbMu.js";import{s as Ea}from"../chunks/DbZgNqix.js";import{e as w}from"../chunks/DANlTl3y.js";import{s as Pa}from"../chunks/CBbLTMDG.js";import{b as Ra}from"../chunks/5UxS6Hio.js";import{p as Z}from"../chunks/CdEA5IGF.js";import{i as Ca}from"../chunks/mO3J0t2N.js";import{b as Na}from"../chunks/CSwq9K3f.js";import{p as Da}from"../chunks/BifvwZtI.js";var Ta=E('<button type="button" class="btn btn-ghost clear-btn">Clear</button>'),Fa=E('<div class="edit-card"><form class="edit-form subpage-form"><input type="hidden" name="id"/> <label>Name<input name="name" required/></label> <label>Email<input name="email" type="email" required/></label> <label>Phone Number<input name="phone" required/></label> <label>Car Number<input name="carNumber" required/></label> <label>House Address<input name="houseAddress" required/></label> <div style="display:flex; gap:0.5rem; margin-top:0.75rem;"><button type="submit" class="btn btn-update">Update</button> <button type="button" class="btn btn-ghost">Cancel</button></div></form></div>'),La=E('<div class="resident-details"><div class="detail-row"><strong>Email:</strong> </div> <div class="detail-row"><strong>Phone:</strong> </div> <div class="detail-row"><strong>Car:</strong> </div> <div class="detail-row"><strong>Address:</strong> </div> <div class="detail-actions"><button type="button" class="edit-btn">Edit</button> <form method="POST" style="display:inline"><button type="submit" class="delete-btn">Delete</button></form></div></div>'),Ma=E('<div><button class="resident-summary"><div class="resident-name"> </div> <div class="resident-house"> </div> <div class="chev"> </div></button> <!></div>'),Oa=E('<div class="toast-wrap" role="status" aria-live="polite"><div class="toast">Resident created successfully</div> <div class="toast-progress"><div class="toast-bar"></div></div></div>'),$a=E('<div class="subpage-container"><div class="subpage-card"><div class="subpage-header"><div><h2 class="subpage-title">Manage Residents</h2></div> <div class="subpage-actions"><a href="/admin/dashboard/residents/create" class="add-resident-btn small-blue">+ Add Resident</a></div></div> <div class="manage-search"><form><div class="search-row"><input type="search" aria-label="Search residents" placeholder="Search by name, email or car"/> <!></div></form></div> <h3>Residents List</h3> <!> <div class="resident-list"></div></div></div> <!>',1);function ee(aa,F){ga(F,!1);const G=h();let ea=Da(F,"data",8),p=h(ea()?.residents??[]);async function ta(e){confirm("Are you sure you want to delete this resident?")&&((await fetch(`/admin/dashboard/residents/${e}/delete`,{method:"POST"})).ok?window.location.reload():alert("Failed to delete resident."))}let o=h(null),c=h(null);function sa(e){v(c,a(c)===e?null:e)}let f=h("");function ra(){v(f,"")}function ia(e){v(o,{...e})}function oa(){v(o,null)}async function da(e){e.preventDefault();const t=e.target,d=new FormData(t),n=a(o)?.id;if(!(await fetch(`/admin/dashboard/residents/${n}/edit`,{method:"POST",body:d})).ok)return;const b=a(p).findIndex(u=>String(u.id)===String(n));b!==-1&&ka(p,a(p)[b]={...a(p)[b],...Object.fromEntries(d)}),v(o,null)}let L=h(!1),M=h(0);ha(()=>{try{const e=new URL(window.location.href);e.searchParams.get("created")==="1"&&(na(),e.searchParams.delete("created"),window.history.replaceState({},"",e.pathname+e.search+e.hash))}catch{}});function na(){v(L,!0),v(M,0);const e=3e3,t=Date.now(),d=()=>{const n=Date.now()-t;v(M,Math.min(100,Math.round(n/e*100))),n<e?requestAnimationFrame(d):setTimeout(()=>v(L,!1),120)};requestAnimationFrame(d)}ya(()=>(a(f),a(p)),()=>{v(G,a(f)?a(p).filter(e=>((e.name??"")+" "+(e.email??"")+" "+(e.carNumber??"")).toLowerCase().includes(a(f).toLowerCase())):a(p))}),wa(),Ca();var J=$a(),O=xa(J),K=i(O),$=s(i(K),2),I=i($),Q=i(I),U=i(Q);y(U);var la=s(U,2);{var va=e=>{var t=Ta();w("click",t,ra),S(e,t)};T(la,e=>{a(f)&&e(va)})}r(Q),r(I),r($);var V=s($,4);{var ca=e=>{var t=Fa(),d=i(t),n=i(d);y(n);var m=s(n,2),b=s(i(m));y(b),r(m);var u=s(m,2),R=s(i(u));y(R),r(u);var x=s(u,2),C=s(i(x));y(C),r(x);var P=s(x,2),N=s(i(P));y(N),r(P);var _=s(P,2),A=s(i(_));y(A),r(_);var k=s(_,2),j=s(i(k),2);r(k),r(d),r(t),D(()=>{q(n,(a(o),l(()=>a(o).id))),q(b,(a(o),l(()=>a(o).name))),q(R,(a(o),l(()=>a(o).email))),q(C,(a(o),l(()=>a(o).phone))),q(N,(a(o),l(()=>a(o).carNumber))),q(A,(a(o),l(()=>a(o).houseAddress)))}),w("click",j,oa),w("submit",d,da),S(e,t)};T(V,e=>{a(o)&&e(ca)})}var W=s(V,2);Sa(W,5,()=>a(G),e=>e.id,(e,t)=>{var d=Ma(),n=i(d),m=i(n),b=i(m,!0);r(m);var u=s(m,2),R=i(u,!0);r(u);var x=s(u,2),C=i(x,!0);r(x),r(n);var P=s(n,2);{var N=_=>{var A=La(),k=i(A),j=s(i(k));r(k);var H=s(k,2),ba=s(i(H));r(H);var z=s(H,2),pa=s(i(z));r(z);var B=s(z,2),fa=s(i(B));r(B);var X=s(B,2),Y=i(X),_a=s(Y,2);r(X),r(A),D(()=>{g(j,` ${a(t),l(()=>a(t).email??"—")??""}`),g(ba,` ${a(t),l(()=>a(t).phone??"—")??""}`),g(pa,` ${a(t),l(()=>a(t).carNumber??"—")??""}`),g(fa,` ${a(t),l(()=>a(t).houseAddress??"—")??""}`)}),w("click",Y,()=>ia(a(t))),w("submit",_a,Z(()=>ta(a(t).id))),S(_,A)};T(P,_=>{a(c),a(t),l(()=>a(c)===a(t).id)&&_(N)})}r(d),D(()=>{Ea(d,1,`resident-item ${a(c),a(t),l(()=>a(c)===a(t).id?"expanded":"")??""}`),qa(n,"aria-expanded",(a(c),a(t),l(()=>a(c)===a(t).id))),g(b,(a(t),l(()=>a(t).name))),g(R,(a(t),l(()=>a(t).houseAddress))),g(C,(a(c),a(t),l(()=>a(c)===a(t).id?"▾":"▸")))}),w("click",n,()=>sa(a(t).id)),S(e,d)}),r(W),r(K),r(O);var ua=s(O,2);{var ma=e=>{var t=Oa(),d=s(i(t),2),n=i(d);r(d),r(t),D(()=>Pa(n,`width:${a(M)??""}%`)),S(e,t)};T(ua,e=>{a(L)&&e(ma)})}Ra(U,()=>a(f),e=>v(f,e)),w("submit",I,Z(function(e){Na.call(this,F,e)})),S(aa,J),Aa()}export{ee as component};
