import"../chunks/DsnmJJEf.js";import"../chunks/i9DHmAX1.js";import{o as W}from"../chunks/BQQlMUYl.js";import{q as X,u as k,p as Y,l as Z,a as ee,f as H,t as J,g as d,b as C,c as te,e as s,d as n,s as f,m as w,r as l}from"../chunks/MgvKJ5Oe.js";import{s as ae}from"../chunks/tNEdk8z3.js";import{i as B}from"../chunks/uYRH7WDe.js";import{r as P,s as re}from"../chunks/STPvjbMu.js";import{e as se}from"../chunks/DANlTl3y.js";import{b as x}from"../chunks/5UxS6Hio.js";import{i as ie}from"../chunks/mO3J0t2N.js";import{s as oe,a as ne}from"../chunks/BIazggEA.js";import{p as le}from"../chunks/CprSpIeg.js";import{a as ce,b as pe,p as me,c as ue}from"../chunks/CK-fib3O.js";function de(t,c,r){X(()=>{var g=k(()=>c(t,r?.())||{});if(g?.destroy)return()=>g.destroy()})}function fe(t){const c=JSON.parse(t);return c.data&&(c.data=me(c.data,ue.decoders)),c}function F(t){return HTMLElement.prototype.cloneNode.call(t)}function ve(t,c=()=>{}){const r=async({action:a,result:i,reset:p=!0,invalidateAll:m=!0})=>{i.type==="success"&&(p&&HTMLFormElement.prototype.reset.call(t),m&&await ce()),(location.origin+location.pathname===a.origin+a.pathname||i.type==="redirect"||i.type==="error")&&await pe(i)};async function g(a){if((a.submitter?.hasAttribute("formmethod")?a.submitter.formMethod:F(t).method)!=="post")return;a.preventDefault();const p=new URL(a.submitter?.hasAttribute("formaction")?a.submitter.formAction:F(t).action),m=a.submitter?.hasAttribute("formenctype")?a.submitter.formEnctype:F(t).enctype,v=new FormData(t),_=a.submitter?.getAttribute("name");_&&v.append(_,a.submitter?.getAttribute("value")??"");const y=new AbortController;let A=!1;const E=await c({action:p,cancel:()=>A=!0,controller:y,formData:v,formElement:t,submitter:a.submitter})??r;if(A)return;let u;try{const o=new Headers({accept:"application/json","x-sveltekit-action":"true"});m!=="multipart/form-data"&&o.set("Content-Type",/^(:?application\/x-www-form-urlencoded|text\/plain)$/.test(m)?m:"application/x-www-form-urlencoded");const L=m==="multipart/form-data"?v:new URLSearchParams(v),h=await fetch(p,{method:"POST",headers:o,cache:"no-store",body:L,signal:y.signal});u=fe(await h.text()),u.type==="error"&&(u.status=h.status)}catch(o){if(o?.name==="AbortError")return;u={type:"error",error:o}}await E({action:p,formData:v,formElement:t,update:o=>r({action:p,result:u,reset:o?.reset,invalidateAll:o?.invalidateAll}),result:u})}return HTMLFormElement.prototype.addEventListener.call(t,"submit",g),{destroy(){HTMLFormElement.prototype.removeEventListener.call(t,"submit",g)}}}var be=H('<p class="message success">Account updated successfully!</p>'),ge=H('<p class="message error"> </p>'),ye=H('<div class="settings-container"><form class="settings-form" method="POST" enctype="multipart/form-data"><div class="subpage-container settings-subpage"><div class="subpage-card settings-card"><div class="subpage-header"><h1 class="subpage-title">Account Settings</h1></div> <div class="profile-pic-section"><img alt="Profile preview" class="profile-pic-preview"/> <label for="profilePicture" class="upload-label">Change Photo <input id="profilePicture" name="profilePicture" type="file" accept="image/*"/></label></div> <div class="form-row"><label for="username">Username</label> <input id="username" name="username" type="text" required/></div> <div class="form-row"><label for="name">Name</label> <input id="name" name="name" type="text" required/></div> <div class="form-row"><label for="email">Email</label> <input id="email" name="email" type="email" required/></div> <div class="form-row"><label for="password">New Password</label> <input id="password" name="password" type="password" placeholder="Leave blank to keep current password" autocomplete="new-password"/></div> <button class="save-btn" type="submit">Save Changes</button> <!> <!></div></div></form></div>');function Ce(t,c){Y(c,!1);const r=()=>ne(le,"$page",g),[g,a]=oe(),i=w();let p=w(""),m=w(""),v=w(""),_=w(""),y=w(""),A=null;W(()=>{d(i)&&(f(p,d(i).name||""),f(m,d(i).email||""),f(v,d(i).username||""),f(y,d(i).profilePic||""))});async function U(e){const b=e.target;b.files&&b.files.length>0&&(A=b.files[0],f(y,URL.createObjectURL(A)))}Z(()=>r(),()=>{f(i,r().data?.user)}),ee(),ie();var E=ye(),u=n(E),o=n(u),L=n(o),h=s(n(L),2),q=n(h),D=s(q,2),G=s(n(D));l(D),l(h);var T=s(h,2),N=s(n(T),2);P(N),l(T);var $=s(T,2),O=s(n($),2);P(O),l($);var M=s($,2),R=s(n(M),2);P(R),l(M);var S=s(M,2),j=s(n(S),2);P(j),l(S);var z=s(S,4);{var I=e=>{var b=be();C(e,b)};B(z,e=>{r(),k(()=>r().form?.success)&&e(I)})}var K=s(z,2);{var Q=e=>{var b=ge(),V=n(b,!0);l(b),J(()=>ae(V,(r(),k(()=>r().form.error)))),C(e,b)};B(K,e=>{r(),k(()=>r().form?.error)&&e(Q)})}l(L),l(o),l(u),de(u,e=>ve?.(e)),l(E),J(()=>re(q,"src",d(y)||"/default-profile.png")),se("change",G,U),x(N,()=>d(v),e=>f(v,e)),x(O,()=>d(p),e=>f(p,e)),x(R,()=>d(m),e=>f(m,e)),x(j,()=>d(_),e=>f(_,e)),C(t,E),te(),a()}export{Ce as component};
