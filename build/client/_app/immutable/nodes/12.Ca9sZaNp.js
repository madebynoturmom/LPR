import"../chunks/DsnmJJEf.js";import"../chunks/COTvsYcR.js";import{o as _e}from"../chunks/DQtEjgo4.js";import{p as he,m as _,aN as ge,aO as we,f as q,b as xe,g as e,c as P,d as Ae,e as i,s,j as v,r,t as D,u as n,aP as ke}from"../chunks/BjJWVY7i.js";import{s as h}from"../chunks/DyiMSgY8.js";import{i as T}from"../chunks/D6O3RN6I.js";import{e as Pe}from"../chunks/DMSwwT4m.js";import{r as g,a as S,s as Se}from"../chunks/DWyjkCdo.js";import{s as qe}from"../chunks/CAznQZM0.js";import{e as w}from"../chunks/CbnbkC1n.js";import{s as Ee}from"../chunks/ZHN8wxDx.js";import{b as Ne}from"../chunks/Btu2CQ7A.js";import{p as Z}from"../chunks/CdEA5IGF.js";import{i as Re}from"../chunks/BbceK8gy.js";import{b as Ce}from"../chunks/CzxUOqbp.js";import{p as De}from"../chunks/DSozhXEh.js";var Te=q('<button type="button" class="btn btn-ghost clear-btn svelte-130yy4t">Clear</button>'),Oe=q('<div class="edit-card"><form class="edit-form subpage-form"><input type="hidden" name="id"/> <label>Name<input name="name" required/></label> <label>Email<input name="email" type="email" required/></label> <label>Phone Number<input name="phone" required/></label> <label>Car Number<input name="carNumber" required/></label> <label>House Address<input name="houseAddress" required/></label> <div style="display:flex; gap:0.5rem; margin-top:0.75rem;"><button type="submit" class="btn btn-update">Update</button> <button type="button" class="btn btn-ghost">Cancel</button></div></form></div>'),Fe=q('<div class="resident-details svelte-130yy4t"><div class="detail-row svelte-130yy4t"><strong>Email:</strong> </div> <div class="detail-row svelte-130yy4t"><strong>Phone:</strong> </div> <div class="detail-row svelte-130yy4t"><strong>Car:</strong> </div> <div class="detail-row svelte-130yy4t"><strong>Address:</strong> </div> <div class="detail-actions svelte-130yy4t"><button type="button" class="edit-btn svelte-130yy4t">Edit</button> <form method="POST" style="display:inline"><button type="submit" class="delete-btn svelte-130yy4t">Delete</button></form></div></div>'),Le=q('<div><button class="resident-summary svelte-130yy4t"><div class="resident-name svelte-130yy4t"> </div> <div class="resident-house svelte-130yy4t"> </div> <div class="chev svelte-130yy4t"> </div></button> <!></div>'),Me=q('<div class="toast-wrap svelte-130yy4t" role="status" aria-live="polite"><div class="toast svelte-130yy4t">Resident created successfully</div> <div class="toast-progress svelte-130yy4t"><div class="toast-bar svelte-130yy4t"></div></div></div>'),$e=q('<div class="subpage-container"><div class="subpage-card"><div class="subpage-header"><div><h2 class="subpage-title">Manage Residents</h2></div> <div class="subpage-actions"><a href="/admin/dashboard/residents/create" class="add-resident-btn small-blue svelte-130yy4t">+ Add Resident</a></div></div> <div class="manage-search svelte-130yy4t"><form><div class="search-row svelte-130yy4t"><input type="search" aria-label="Search residents" placeholder="Search by name, email or car" class="svelte-130yy4t"/> <!></div></form></div> <h3>Residents List</h3> <!> <div class="resident-list svelte-130yy4t"></div></div></div> <!>',1);function tt(ee,O){he(O,!1);const G=_();let te=De(O,"data",8),p=_(te()?.residents??[]);async function ae(t){confirm("Are you sure you want to delete this resident?")&&((await fetch(`/admin/dashboard/residents/${t}/delete`,{method:"POST"})).ok?window.location.reload():alert("Failed to delete resident."))}let o=_(null),c=_(null);function se(t){v(c,e(c)===t?null:t)}let f=_("");function re(){v(f,"")}function ie(t){v(o,{...t})}function oe(){v(o,null)}async function le(t){t.preventDefault();const a=t.target,l=new FormData(a),d=e(o)?.id;if(!(await fetch(`/admin/dashboard/residents/${d}/edit`,{method:"POST",body:l})).ok)return;const b=e(p).findIndex(u=>String(u.id)===String(d));b!==-1&&ke(p,e(p)[b]={...e(p)[b],...Object.fromEntries(l)}),v(o,null)}let F=_(!1),L=_(0);_e(()=>{try{const t=new URL(window.location.href);t.searchParams.get("created")==="1"&&(de(),t.searchParams.delete("created"),window.history.replaceState({},"",t.pathname+t.search+t.hash))}catch{}});function de(){v(F,!0),v(L,0);const t=3e3,a=Date.now(),l=()=>{const d=Date.now()-a;v(L,Math.min(100,Math.round(d/t*100))),d<t?requestAnimationFrame(l):setTimeout(()=>v(F,!1),120)};requestAnimationFrame(l)}ge(()=>(e(f),e(p)),()=>{v(G,e(f)?e(p).filter(t=>((t.name??"")+" "+(t.email??"")+" "+(t.carNumber??"")).toLowerCase().includes(e(f).toLowerCase())):e(p))}),we(),Re();var J=$e(),M=xe(J),K=i(M),$=s(i(K),2),j=i($),Q=i(j),I=i(Q);g(I);var ne=s(I,2);{var ve=t=>{var a=Te();w("click",a,re),P(t,a)};T(ne,t=>{e(f)&&t(ve)})}r(Q),r(j),r($);var V=s($,4);{var ce=t=>{var a=Oe(),l=i(a),d=i(l);g(d);var m=s(d,2),b=s(i(m));g(b),r(m);var u=s(m,2),N=s(i(u));g(N),r(u);var x=s(u,2),R=s(i(x));g(R),r(x);var E=s(x,2),C=s(i(E));g(C),r(E);var y=s(E,2),A=s(i(y));g(A),r(y);var k=s(y,2),U=s(i(k),2);r(k),r(l),r(a),D(()=>{S(d,(e(o),n(()=>e(o).id))),S(b,(e(o),n(()=>e(o).name))),S(N,(e(o),n(()=>e(o).email))),S(R,(e(o),n(()=>e(o).phone))),S(C,(e(o),n(()=>e(o).carNumber))),S(A,(e(o),n(()=>e(o).houseAddress)))}),w("click",U,oe),w("submit",l,le),P(t,a)};T(V,t=>{e(o)&&t(ce)})}var W=s(V,2);Pe(W,5,()=>e(G),t=>t.id,(t,a)=>{var l=Le(),d=i(l),m=i(d),b=i(m,!0);r(m);var u=s(m,2),N=i(u,!0);r(u);var x=s(u,2),R=i(x,!0);r(x),r(d);var E=s(d,2);{var C=y=>{var A=Fe(),k=i(A),U=s(i(k));r(k);var H=s(k,2),be=s(i(H));r(H);var z=s(H,2),pe=s(i(z));r(z);var B=s(z,2),fe=s(i(B));r(B);var X=s(B,2),Y=i(X),ye=s(Y,2);r(X),r(A),D(()=>{h(U,` ${e(a),n(()=>e(a).email??"—")??""}`),h(be,` ${e(a),n(()=>e(a).phone??"—")??""}`),h(pe,` ${e(a),n(()=>e(a).carNumber??"—")??""}`),h(fe,` ${e(a),n(()=>e(a).houseAddress??"—")??""}`)}),w("click",Y,()=>ie(e(a))),w("submit",ye,Z(()=>ae(e(a).id))),P(y,A)};T(E,y=>{e(c),e(a),n(()=>e(c)===e(a).id)&&y(C)})}r(l),D(()=>{qe(l,1,`resident-item ${e(c),e(a),n(()=>e(c)===e(a).id?"expanded":"")??""}`,"svelte-130yy4t"),Se(d,"aria-expanded",(e(c),e(a),n(()=>e(c)===e(a).id))),h(b,(e(a),n(()=>e(a).name))),h(N,(e(a),n(()=>e(a).houseAddress))),h(R,(e(c),e(a),n(()=>e(c)===e(a).id?"▾":"▸")))}),w("click",d,()=>se(e(a).id)),P(t,l)}),r(W),r(K),r(M);var ue=s(M,2);{var me=t=>{var a=Me(),l=s(i(a),2),d=i(l);r(l),r(a),D(()=>Ee(d,`width:${e(L)??""}%`)),P(t,a)};T(ue,t=>{e(F)&&t(me)})}Ne(I,()=>e(f),t=>v(f,t)),w("submit",j,Z(function(t){Ce.call(this,O,t)})),P(ee,J),Ae()}export{tt as component};
