import"../chunks/DsnmJJEf.js";import"../chunks/Dr5p_gXH.js";import{o as dt}from"../chunks/G6y-YXti.js";import{p as nt,m as f,f as h,c as _,d as ot,s as n,e as r,j as o,g as t,n as G,r as i,t as w,u as m,aP as H}from"../chunks/D6_VZFDO.js";import{s as x}from"../chunks/BDSG5-H0.js";import{i as A}from"../chunks/BdvQLAZU.js";import{e as vt,i as lt}from"../chunks/g0qwyJPX.js";import{r as M,a as J}from"../chunks/BfIrQ_zr.js";import{s as ut}from"../chunks/C80BVqqJ.js";import{e as k}from"../chunks/DtrBNwtL.js";import{s as ct}from"../chunks/Dr4jViYc.js";import{b as mt}from"../chunks/Cko499XQ.js";import{i as pt}from"../chunks/CmAcq_e6.js";import{p as bt}from"../chunks/BWorSmfV.js";var ft=h('<div class="toast-wrap" role="status" aria-live="polite"><div class="toast">Admin deleted</div> <div class="toast-progress"><div class="toast-bar"></div></div></div>'),_t=h('<div class="error svelte-1p68bdi"> </div>'),ht=h('<div class="edit-card svelte-1p68bdi"><form class="edit-form subpage-form svelte-1p68bdi"><input type="hidden" name="id"/> <label for="username">Username</label> <input id="username" name="username" type="text" required/> <div style="display:flex; gap:0.5rem; margin-top:0.75rem;"><button type="submit" class="btn btn-update svelte-1p68bdi">Update</button> <button type="button" class="btn btn-ghost svelte-1p68bdi">Cancel</button></div></form></div>'),gt=h('<div class="resident-details svelte-1p68bdi"><div class="detail-row svelte-1p68bdi"><strong>Username:</strong> </div> <div class="detail-actions svelte-1p68bdi"><button type="button" class="edit-btn">Edit</button> <form method="POST" action="?/deleteAdmin" style="display:inline"><input type="hidden" name="id"/> <button type="submit" class="delete-btn">Delete</button></form></div></div>'),yt=h('<div><button class="resident-summary svelte-1p68bdi"><div class="resident-name svelte-1p68bdi"> </div> <div class="chev svelte-1p68bdi"> </div></button> <!></div>'),wt=h('<div class="subpage-container"><div class="subpage-card"><div class="subpage-header svelte-1p68bdi"><div><h2 class="subpage-title">Manage Admins</h2></div> <!> <div class="subpage-actions svelte-1p68bdi"><a class="btn btn-create svelte-1p68bdi" href="/admin/dashboard/admins/create">+ Add Admin</a></div></div> <!> <div class="admin-list-card svelte-1p68bdi"><!> <div class="resident-list svelte-1p68bdi"></div></div></div></div>');function jt(K,q){nt(q,!1);let N=bt(q,"data",8),g=f(N()?.admins??[]),p=f(null),v=f(null);function Q(e){o(v,{...e}),o(p,null)}function V(){o(v,null),o(p,null)}let u=f(null),D=f(!1),P=f(0);function W(e){o(u,t(u)===e?null:e)}dt(()=>{try{const e=new URL(window.location.href);e.searchParams.get("deleted")==="1"&&(X(),e.searchParams.delete("deleted"),window.history.replaceState({},"",e.pathname+e.search+e.hash))}catch{}});function X(){o(D,!0),o(P,0);const e=3e3,a=Date.now(),s=()=>{const d=Date.now()-a;o(P,Math.min(100,Math.round(d/e*100))),d<e?requestAnimationFrame(s):setTimeout(()=>o(D,!1),120)};requestAnimationFrame(s)}async function Y(e){e.preventDefault(),o(p,null);const a=e.target,s=new FormData(a);if(!(await fetch("?/updateAdmin",{method:"POST",body:s})).ok){o(p,"Failed to update admin");return}const l=s.get("id"),b=s.get("username"),c=t(g).findIndex(y=>String(y.id)===String(l));c!==-1&&H(g,t(g)[c]={...t(g)[c],username:b}),o(v,null)}pt();var E=wt(),I=r(E),S=r(I),Z=n(r(S),2);{var tt=e=>{var a=ft(),s=n(r(a),2),d=r(s);i(s),i(a),w(()=>ct(d,`width:${t(P)??""}%`)),_(e,a)};A(Z,e=>{t(D)&&e(tt)})}G(2),i(S);var O=n(S,2);{var et=e=>{var a=_t(),s=r(a,!0);i(a),w(()=>x(s,t(p))),_(e,a)};A(O,e=>{t(p)&&e(et)})}var j=n(O,2),C=r(j);{var at=e=>{var a=ht(),s=r(a),d=r(s);M(d);var l=n(d,4);M(l);var b=n(l,2),c=n(r(b),2);i(b),i(s),i(a),w(()=>J(d,(t(v),m(()=>t(v).id)))),mt(l,()=>t(v).username,y=>H(v,t(v).username=y)),k("click",c,V),k("submit",s,Y),_(e,a)};A(C,e=>{t(v)&&e(at)})}var L=n(C,2);vt(L,5,()=>t(g),lt,(e,a)=>{var s=yt(),d=r(s),l=r(d),b=r(l,!0);i(l);var c=n(l,2),y=r(c,!0);i(c),i(d);var st=n(d,2);{var it=T=>{var U=gt(),F=r(U),rt=n(r(F));i(F);var R=n(F,2),$=r(R),z=n($,2),B=r(z);M(B),G(2),i(z),i(R),i(U),w(()=>{x(rt,` ${t(a),m(()=>t(a).username)??""}`),J(B,(t(a),m(()=>t(a).id)))}),k("click",$,()=>Q(t(a))),_(T,U)};A(st,T=>{t(u),t(a),m(()=>t(u)===t(a).id)&&T(it)})}i(s),w(()=>{ut(s,1,`resident-item ${t(u),t(a),m(()=>t(u)===t(a).id?"expanded":"")??""}`,"svelte-1p68bdi"),x(b,(t(a),m(()=>t(a).username))),x(y,(t(u),t(a),m(()=>t(u)===t(a).id?"▾":"▸")))}),k("click",d,()=>W(t(a).id)),_(e,s)}),i(L),i(j),i(I),i(E),_(K,E),ot()}export{jt as component};
