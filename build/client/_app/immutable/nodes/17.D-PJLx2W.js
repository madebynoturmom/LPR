import"../chunks/DsnmJJEf.js";import"../chunks/Dr5p_gXH.js";import{o as W}from"../chunks/G6y-YXti.js";import{aS as X,u as k,p as Y,aN as Z,aO as ee,f as H,t as J,g as d,c as C,d as te,s,j as f,m as w,e as l,r as n}from"../chunks/D6_VZFDO.js";import{s as ae}from"../chunks/BDSG5-H0.js";import{i as B}from"../chunks/BdvQLAZU.js";import{r as L,s as re}from"../chunks/BfIrQ_zr.js";import{e as se}from"../chunks/DtrBNwtL.js";import{b as P}from"../chunks/Cko499XQ.js";import{i as ie}from"../chunks/CmAcq_e6.js";import{s as oe,a as le}from"../chunks/DPinqpzW.js";import{p as ne}from"../chunks/Vfgx5o8E.js";import{a as ce,b as pe,p as me,c as ue}from"../chunks/DdKCIZXj.js";function de(t,c,r){X(()=>{var y=k(()=>c(t,r?.())||{});if(y?.destroy)return()=>y.destroy()})}function fe(t){const c=JSON.parse(t);return c.data&&(c.data=me(c.data,ue.decoders)),c}function F(t){return HTMLElement.prototype.cloneNode.call(t)}function ve(t,c=()=>{}){const r=async({action:a,result:i,reset:p=!0,invalidateAll:m=!0})=>{i.type==="success"&&(p&&HTMLFormElement.prototype.reset.call(t),m&&await ce()),(location.origin+location.pathname===a.origin+a.pathname||i.type==="redirect"||i.type==="error")&&await pe(i)};async function y(a){if((a.submitter?.hasAttribute("formmethod")?a.submitter.formMethod:F(t).method)!=="post")return;a.preventDefault();const p=new URL(a.submitter?.hasAttribute("formaction")?a.submitter.formAction:F(t).action),m=a.submitter?.hasAttribute("formenctype")?a.submitter.formEnctype:F(t).enctype,v=new FormData(t),_=a.submitter?.getAttribute("name");_&&v.append(_,a.submitter?.getAttribute("value")??"");const g=new AbortController;let x=!1;const A=await c({action:p,cancel:()=>x=!0,controller:g,formData:v,formElement:t,submitter:a.submitter})??r;if(x)return;let u;try{const o=new Headers({accept:"application/json","x-sveltekit-action":"true"});m!=="multipart/form-data"&&o.set("Content-Type",/^(:?application\/x-www-form-urlencoded|text\/plain)$/.test(m)?m:"application/x-www-form-urlencoded");const E=m==="multipart/form-data"?v:new URLSearchParams(v),h=await fetch(p,{method:"POST",headers:o,cache:"no-store",body:E,signal:g.signal});u=fe(await h.text()),u.type==="error"&&(u.status=h.status)}catch(o){if(o?.name==="AbortError")return;u={type:"error",error:o}}await A({action:p,formData:v,formElement:t,update:o=>r({action:p,result:u,reset:o?.reset,invalidateAll:o?.invalidateAll}),result:u})}return HTMLFormElement.prototype.addEventListener.call(t,"submit",y),{destroy(){HTMLFormElement.prototype.removeEventListener.call(t,"submit",y)}}}var be=H('<p class="message success svelte-6y6vmx">Account updated successfully!</p>'),ye=H('<p class="message error svelte-6y6vmx"> </p>'),ge=H('<div class="settings-container svelte-6y6vmx"><form class="settings-form svelte-6y6vmx" method="POST" enctype="multipart/form-data"><div class="subpage-container settings-subpage"><div class="subpage-card settings-card svelte-6y6vmx"><div class="subpage-header svelte-6y6vmx"><h1 class="subpage-title svelte-6y6vmx">Account Settings</h1></div> <div class="profile-pic-section svelte-6y6vmx"><img alt="Profile preview" class="profile-pic-preview svelte-6y6vmx"/> <label for="profilePicture" class="upload-label svelte-6y6vmx">Change Photo <input id="profilePicture" name="profilePicture" type="file" accept="image/*" class="svelte-6y6vmx"/></label></div> <div class="form-row"><label for="username">Username</label> <input id="username" name="username" type="text" required/></div> <div class="form-row"><label for="name">Name</label> <input id="name" name="name" type="text" required/></div> <div class="form-row"><label for="email">Email</label> <input id="email" name="email" type="email" required/></div> <div class="form-row"><label for="password">New Password</label> <input id="password" name="password" type="password" placeholder="Leave blank to keep current password" autocomplete="new-password"/></div> <button class="save-btn" type="submit">Save Changes</button> <!> <!></div></div></form></div>');function Ce(t,c){Y(c,!1);const r=()=>le(ne,"$page",y),[y,a]=oe(),i=w();let p=w(""),m=w(""),v=w(""),_=w(""),g=w(""),x=null;W(()=>{d(i)&&(f(p,d(i).name||""),f(m,d(i).email||""),f(v,d(i).username||""),f(g,d(i).profilePic||""))});async function N(e){const b=e.target;b.files&&b.files.length>0&&(x=b.files[0],f(g,URL.createObjectURL(x)))}Z(()=>r(),()=>{f(i,r().data?.user)}),ee(),ie();var A=ge(),u=l(A),o=l(u),E=l(o),h=s(l(E),2),O=l(h),U=s(O,2),G=s(l(U));n(U),n(h);var S=s(h,2),D=s(l(S),2);L(D),n(S);var T=s(S,2),R=s(l(T),2);L(R),n(T);var $=s(T,2),j=s(l($),2);L(j),n($);var M=s($,2),q=s(l(M),2);L(q),n(M);var z=s(M,4);{var I=e=>{var b=be();C(e,b)};B(z,e=>{r(),k(()=>r().form?.success)&&e(I)})}var K=s(z,2);{var Q=e=>{var b=ye(),V=l(b,!0);n(b),J(()=>ae(V,(r(),k(()=>r().form.error)))),C(e,b)};B(K,e=>{r(),k(()=>r().form?.error)&&e(Q)})}n(E),n(o),n(u),de(u,e=>ve?.(e)),n(A),J(()=>re(O,"src",d(g)||"/default-profile.png")),se("change",G,N),P(D,()=>d(v),e=>f(v,e)),P(R,()=>d(p),e=>f(p,e)),P(j,()=>d(m),e=>f(m,e)),P(q,()=>d(_),e=>f(_,e)),C(t,A),te(),a()}export{Ce as component};
