import"../chunks/DsnmJJEf.js";import"../chunks/DsPuBiMm.js";import{o as dt}from"../chunks/BaSLTKbU.js";import{p as nt,m as _,f as h,b,c as ot,e as n,d as r,s as o,g as t,n as G,r as i,t as w,u as m,h as H}from"../chunks/N5lxWZGS.js";import{s as x}from"../chunks/B135_YsI.js";import{i as A}from"../chunks/DrWauV8B.js";import{e as vt,i as lt}from"../chunks/DSP_IF8R.js";import{r as M,a as J}from"../chunks/BnZ110ug.js";import{s as ut}from"../chunks/Ct8xIc2f.js";import{e as k}from"../chunks/Dx3h8YKD.js";import{s as ct}from"../chunks/BrKrArgY.js";import{b as mt}from"../chunks/DnwoYYiD.js";import{i as pt}from"../chunks/Bc0xGMnQ.js";import{p as ft}from"../chunks/BBnkIoAR.js";var _t=h('<div class="toast-wrap" role="status" aria-live="polite"><div class="toast">Admin deleted</div> <div class="toast-progress"><div class="toast-bar"></div></div></div>'),bt=h('<div class="error"> </div>'),ht=h('<div class="edit-card"><form class="edit-form subpage-form"><input type="hidden" name="id"/> <label for="username">Username</label> <input id="username" name="username" type="text" required/> <div style="display:flex; gap:0.5rem; margin-top:0.75rem;"><button type="submit" class="btn btn-update">Update</button> <button type="button" class="btn btn-ghost">Cancel</button></div></form></div>'),gt=h('<div class="resident-details"><div class="detail-row"><strong>Username:</strong> </div> <div class="detail-actions"><button type="button" class="edit-btn">Edit</button> <form method="POST" action="?/deleteAdmin" style="display:inline"><input type="hidden" name="id"/> <button type="submit" class="delete-btn">Delete</button></form></div></div>'),yt=h('<div><button class="resident-summary"><div class="resident-name"> </div> <div class="chev"> </div></button> <!></div>'),wt=h('<div class="subpage-container"><div class="subpage-card"><div class="subpage-header"><div><h2 class="subpage-title">Manage Admins</h2></div> <!> <div class="subpage-actions"><a class="btn btn-create" href="/admin/dashboard/admins/create">+ Add Admin</a></div></div> <!> <div class="admin-list-card"><!> <div class="resident-list"></div></div></div></div>');function Ct(K,q){nt(q,!1);let N=ft(q,"data",8),g=_(N()?.admins??[]),p=_(null),v=_(null);function Q(e){o(v,{...e}),o(p,null)}function V(){o(v,null),o(p,null)}let u=_(null),D=_(!1),E=_(0);function W(e){o(u,t(u)===e?null:e)}dt(()=>{try{const e=new URL(window.location.href);e.searchParams.get("deleted")==="1"&&(X(),e.searchParams.delete("deleted"),window.history.replaceState({},"",e.pathname+e.search+e.hash))}catch{}});function X(){o(D,!0),o(E,0);const e=3e3,a=Date.now(),s=()=>{const d=Date.now()-a;o(E,Math.min(100,Math.round(d/e*100))),d<e?requestAnimationFrame(s):setTimeout(()=>o(D,!1),120)};requestAnimationFrame(s)}async function Y(e){e.preventDefault(),o(p,null);const a=e.target,s=new FormData(a);if(!(await fetch("?/updateAdmin",{method:"POST",body:s})).ok){o(p,"Failed to update admin");return}const l=s.get("id"),f=s.get("username"),c=t(g).findIndex(y=>String(y.id)===String(l));c!==-1&&H(g,t(g)[c]={...t(g)[c],username:f}),o(v,null)}pt();var P=wt(),I=r(P),S=r(I),Z=n(r(S),2);{var tt=e=>{var a=_t(),s=n(r(a),2),d=r(s);i(s),i(a),w(()=>ct(d,`width:${t(E)??""}%`)),b(e,a)};A(Z,e=>{t(D)&&e(tt)})}G(2),i(S);var O=n(S,2);{var et=e=>{var a=bt(),s=r(a,!0);i(a),w(()=>x(s,t(p))),b(e,a)};A(O,e=>{t(p)&&e(et)})}var C=n(O,2),L=r(C);{var at=e=>{var a=ht(),s=r(a),d=r(s);M(d);var l=n(d,4);M(l);var f=n(l,2),c=n(r(f),2);i(f),i(s),i(a),w(()=>J(d,(t(v),m(()=>t(v).id)))),mt(l,()=>t(v).username,y=>H(v,t(v).username=y)),k("click",c,V),k("submit",s,Y),b(e,a)};A(L,e=>{t(v)&&e(at)})}var R=n(L,2);vt(R,5,()=>t(g),lt,(e,a)=>{var s=yt(),d=r(s),l=r(d),f=r(l,!0);i(l);var c=n(l,2),y=r(c,!0);i(c),i(d);var st=n(d,2);{var it=T=>{var U=gt(),F=r(U),rt=n(r(F));i(F);var $=n(F,2),j=r($),z=n(j,2),B=r(z);M(B),G(2),i(z),i($),i(U),w(()=>{x(rt,` ${t(a),m(()=>t(a).username)??""}`),J(B,(t(a),m(()=>t(a).id)))}),k("click",j,()=>Q(t(a))),b(T,U)};A(st,T=>{t(u),t(a),m(()=>t(u)===t(a).id)&&T(it)})}i(s),w(()=>{ut(s,1,`resident-item ${t(u),t(a),m(()=>t(u)===t(a).id?"expanded":"")??""}`),x(f,(t(a),m(()=>t(a).username))),x(y,(t(u),t(a),m(()=>t(u)===t(a).id?"▾":"▸")))}),k("click",d,()=>W(t(a).id)),b(e,s)}),i(R),i(C),i(I),i(P),b(K,P),ot()}export{Ct as component};
