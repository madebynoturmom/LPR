import"../chunks/DsnmJJEf.js";import"../chunks/Dr5p_gXH.js";import{o as yt}from"../chunks/G6y-YXti.js";import{p as gt,m as D,f as b,b as et,c as m,d as wt,j as c,e,s as i,g as t,u as o,r as s,t as T,aP as xt}from"../chunks/D6_VZFDO.js";import{s as x}from"../chunks/BDSG5-H0.js";import{i as A}from"../chunks/BdvQLAZU.js";import{e as Pt,i as Dt}from"../chunks/g0qwyJPX.js";import{r as F,a as M}from"../chunks/BfIrQ_zr.js";import{e as C}from"../chunks/DtrBNwtL.js";import{s as It}from"../chunks/Dr4jViYc.js";import{s as st}from"../chunks/CdEA5IGF.js";import{i as Gt}from"../chunks/CmAcq_e6.js";import{b as kt}from"../chunks/BBGkhqTr.js";import{p as St}from"../chunks/BWorSmfV.js";var qt=b('<div class="error"> </div>'),Et=b('<tr class="edit-row svelte-18p1ya8"><td colspan="3" class="svelte-18p1ya8"><div class="edit-card svelte-18p1ya8"><form class="edit-form subpage-form svelte-18p1ya8"><input type="hidden" name="id" class="svelte-18p1ya8"/> <label class="svelte-18p1ya8">Name<input name="name" required class="svelte-18p1ya8"/></label> <label class="svelte-18p1ya8">Phone<input name="phone" required class="svelte-18p1ya8"/></label> <label class="svelte-18p1ya8">Guard ID<input name="guardId" required class="svelte-18p1ya8"/></label> <div style="display:flex; gap:0.5rem; margin-top:0.75rem;"><button type="submit" class="btn btn-update">Update</button> <button type="button" class="btn btn-ghost">Cancel</button></div> <!></form></div></td></tr>'),Nt=b('<tr class="guard-details svelte-18p1ya8"><td colspan="3" class="svelte-18p1ya8"><div class="resident-details" style="padding:0.75rem 0;"><div class="detail-row"><strong>Name:</strong> </div> <div class="detail-row"><strong>Phone:</strong> </div> <div class="detail-row"><strong>Guard ID:</strong> </div> <div class="detail-actions" style="margin-top:0.5rem;"><button type="button" class="edit-btn">Edit</button> <form method="POST" action="?/delete" style="display:inline"><input type="hidden" name="id"/> <button type="submit" class="delete-btn"></button></form></div></div></td></tr>'),Tt=b('<tr class="guard-summary svelte-18p1ya8"><td data-label="Name" class="svelte-18p1ya8"> </td><td data-label="Phone" class="svelte-18p1ya8"> </td><td data-label="Guard ID" class="svelte-18p1ya8"> </td></tr> <!>',1),At=b('<table class="guard-table svelte-18p1ya8"><thead class="svelte-18p1ya8"><tr class="svelte-18p1ya8"><th class="svelte-18p1ya8">Name</th><th class="svelte-18p1ya8">Phone</th><th class="svelte-18p1ya8">Guard ID</th></tr></thead><tbody class="svelte-18p1ya8"><!><!></tbody></table>'),Ft=b("<p>No guards found.</p>"),Mt=b('<div class="toast-wrap" role="status" aria-live="polite"><div class="toast">Guard deleted</div> <div class="toast-progress"><div class="toast-bar"></div></div></div>'),Ct=b('<div class="subpage-container"><div class="subpage-card"><div class="subpage-header"><div><h2 class="subpage-title">Manage Guards</h2></div> <div class="subpage-actions"><a href="/admin/dashboard/guards/create" class="add-guard-btn">+ Add Guard</a></div></div> <h3>Guards List</h3> <!></div></div>  <!>',1);function Yt(rt,B){gt(B,!1);let it=St(B,"data",8),f=D(it()?.guards??[]),d=D(null),I=D(null),L=D(null);function lt(a){const l=String(a);c(L,t(L)===l?null:l)}function dt(a){c(d,{...a}),c(I,null)}function ot(){c(d,null),c(I,null)}let H=D(!1),J=D(0);yt(()=>{try{const a=new URL(window.location.href);a.searchParams.get("deleted")==="1"&&(nt(),a.searchParams.delete("deleted"),window.history.replaceState({},"",a.pathname+a.search+a.hash))}catch{}});function nt(){c(H,!0),c(J,0);const a=3e3,l=Date.now(),n=()=>{const p=Date.now()-l;c(J,Math.min(100,Math.round(p/a*100))),p<a?requestAnimationFrame(n):setTimeout(()=>c(H,!1),120)};requestAnimationFrame(n)}async function vt(a){a.preventDefault();const l=a.target,n=new FormData(l),p=t(d)?.id;if(!(await fetch(`/admin/dashboard/guards/${p}/edit`,{method:"POST",body:n})).ok){c(I,"Failed to update guard (server may need an edit endpoint)");return}const G=t(f).findIndex(u=>String(u.id)===String(p));if(G!==-1){const u=Array.from(n.entries()).reduce((r,[_,v])=>(r[String(_)]=v,r),{});xt(f,t(f)[G]={...t(f)[G],...u})}c(d,null)}Gt();var W=Ct(),K=et(W),X=e(K),ct=i(e(X),4);{var pt=a=>{var l=At(),n=i(e(l)),p=e(n);{var Y=u=>{var r=Et(),_=e(r),v=e(_),h=e(v),k=e(h);F(k);var y=i(k,2),O=i(e(y));F(O),s(y);var P=i(y,2),U=i(e(P));F(U),s(P);var S=i(P,2),j=i(e(S));F(j),s(S);var g=i(S,2),q=i(e(g),2);s(g);var R=i(g,2);{var z=w=>{var E=qt(),N=e(E,!0);s(E),T(()=>x(N,t(I))),m(w,E)};A(R,w=>{t(I)&&w(z)})}s(h),s(v),s(_),s(r),T(()=>{M(k,(t(d),o(()=>t(d).id))),M(O,(t(d),o(()=>t(d).name))),M(U,(t(d),o(()=>t(d).phone))),M(j,(t(d),o(()=>t(d).guardId)))}),C("click",q,ot),C("submit",h,vt),m(u,r)};A(p,u=>{t(d)&&u(Y)})}var G=i(p);Pt(G,1,()=>t(f),Dt,(u,r)=>{var _=Tt(),v=et(_),h=e(v),k=e(h,!0);s(h);var y=i(h),O=e(y,!0);s(y);var P=i(y),U=e(P,!0);s(P),s(v);var S=i(v,2);{var j=g=>{var q=Nt(),R=e(q),z=e(R),w=e(z),E=i(e(w));s(w);var N=i(w,2),ft=i(e(N));s(N);var Q=i(N,2),_t=i(e(Q));s(Q);var Z=i(Q,2),$=e(Z),tt=i($,2),V=e(tt);F(V);var at=i(V,2);at.textContent="Delete",s(tt),s(Z),s(z),s(R),s(q),T(()=>{x(E,` ${t(r),o(()=>t(r).name??"—")??""}`),x(ft,` ${t(r),o(()=>t(r).phone??"—")??""}`),x(_t,` ${t(r),o(()=>t(r).guardId??"—")??""}`),M(V,(t(r),o(()=>t(r).id)))}),C("click",$,st(()=>dt(t(r)))),C("click",at,st(function(ht){kt.call(this,B,ht)})),m(g,q)};A(S,g=>{t(L),t(r),o(()=>t(L)===String(t(r).id))&&g(j)})}T(()=>{x(k,(t(r),o(()=>t(r).name??"-"))),x(O,(t(r),o(()=>t(r).phone??"-"))),x(U,(t(r),o(()=>t(r).guardId??"-")))}),C("click",v,()=>lt(t(r).id)),m(u,_)}),s(n),s(l),m(a,l)},ut=a=>{var l=Ft();m(a,l)};A(ct,a=>{t(f),o(()=>t(f).length>0)?a(pt):a(ut,!1)})}s(X),s(K);var mt=i(K,2);{var bt=a=>{var l=Mt(),n=i(e(l),2),p=e(n);s(n),s(l),T(()=>It(p,`width:${t(J)??""}%`)),m(a,l)};A(mt,a=>{t(H)&&a(bt)})}m(rt,W),wt()}export{Yt as component};
