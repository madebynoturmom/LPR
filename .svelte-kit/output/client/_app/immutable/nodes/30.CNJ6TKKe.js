import"../chunks/DsnmJJEf.js";import"../chunks/Dr5p_gXH.js";import{p as me,aN as ye,aO as be,f as B,s,b as _e,t as U,g as l,c as O,d as we,e as r,j as a,m as i,r as t}from"../chunks/D6_VZFDO.js";import{s as Z}from"../chunks/BDSG5-H0.js";import{i as ee}from"../chunks/BdvQLAZU.js";import{r as d,s as he}from"../chunks/BfIrQ_zr.js";import{e as R}from"../chunks/DtrBNwtL.js";import{b as v}from"../chunks/Cko499XQ.js";import{p as se}from"../chunks/CdEA5IGF.js";import{i as je}from"../chunks/CmAcq_e6.js";import{s as ge,a as Pe}from"../chunks/DPinqpzW.js";import{p as Ae}from"../chunks/R1TULxha.js";import{i as ae}from"../chunks/D9W8X6Gc.js";var xe=B('<div class="message svelte-n628yj"> </div>'),De=B('<div class="message svelte-n628yj"> </div>'),Ce=B('<a href="/user/dashboard" class="back-btn svelte-n628yj">&larr; Back to Dashboard</a> <div class="profile-card move-up svelte-n628yj"><h1>Account Settings</h1> <div class="profile-forms-row svelte-n628yj"><div class="profile-settings-col svelte-n628yj"><form class="profile-form svelte-n628yj" enctype="multipart/form-data"><div class="profile-pic-section svelte-n628yj"><img alt="Profile preview" class="profile-pic-preview svelte-n628yj"/> <label for="profilePicture" class="upload-label svelte-n628yj"><span>Change Photo</span> <input id="profilePicture" name="profilePicture" type="file" accept="image/*" class="svelte-n628yj"/></label></div> <div class="form-grid svelte-n628yj"><div class="form-row svelte-n628yj"><label for="username" class="svelte-n628yj">Username</label> <input id="username" name="username" type="text" required class="svelte-n628yj"/></div> <div class="form-row svelte-n628yj"><label for="name" class="svelte-n628yj">Name</label> <input id="name" name="name" type="text" required class="svelte-n628yj"/></div> <div class="form-row svelte-n628yj"><label for="email" class="svelte-n628yj">Email</label> <input id="email" name="email" type="email" required class="svelte-n628yj"/></div> <div class="form-row svelte-n628yj"><label for="phone" class="svelte-n628yj">Phone</label> <input id="phone" name="phone" type="text" class="svelte-n628yj"/></div> <div class="form-row svelte-n628yj"><label for="houseAddress" class="svelte-n628yj">House Address</label> <input id="houseAddress" name="houseAddress" type="text" class="svelte-n628yj"/></div></div> <button class="save-btn svelte-n628yj" type="submit">Save Changes</button> <!></form></div> <div class="password-col svelte-n628yj"><form class="password-form" autocomplete="off"><h2>Change Password</h2> <div class="form-row svelte-n628yj"><label for="currentPassword" class="svelte-n628yj">Current Password</label> <input id="currentPassword" type="password" required autocomplete="current-password" class="svelte-n628yj"/></div> <div class="form-row svelte-n628yj"><label for="newPassword" class="svelte-n628yj">New Password</label> <input id="newPassword" type="password" required autocomplete="new-password" class="svelte-n628yj"/></div> <button class="save-btn password-btn svelte-n628yj" type="submit">Update Password</button> <!></form></div></div></div>',1);function Me(re,te){me(te,!1);const y=()=>Pe(Ae,"$page",le),[le,oe]=ge();let b=i(""),_=i(""),w=i(""),f=i(""),u=i(""),m=i("");async function ie(e){if(e.preventDefault(),!l(f)||!l(u)){a(m,"Please fill in both fields.");return}a(m,"Password updated successfully!"),a(f,""),a(u,"")}let h=i(""),j=i(""),g=i(null),c=i("");function ne(e){const o=e.target;if(o.files&&o.files[0]){const n=new FileReader;n.onload=p=>{a(g,p.target?.result)},n.readAsDataURL(o.files[0])}}async function de(e){e.preventDefault();const o=e.target,n=new FormData(o);try{const p=await fetch("/user/dashboard/profile",{method:"POST",body:n}),Y=await p.json();p.ok?(a(c,Y.message||"Profile updated successfully!"),await ae("app:profile"),await ae("/user/dashboard")):a(c,Y.error||"Failed to update profile.")}catch(p){console.error("Profile update error:",p),a(c,"An error occurred while updating your profile.")}}ye(()=>y(),()=>{if(y().data.user){const e=y().data.user;a(b,e.name||""),a(_,e.email||""),a(w,e.username||""),a(h,e.phone||""),a(j,e.houseAddress||""),a(g,e.profilePic||null)}}),be(),je();var E=Ce(),H=s(_e(E),2),L=s(r(H),2),P=r(L),A=r(P),x=r(A),M=r(x),T=s(M,2),ve=s(r(T),2);t(T),t(x);var D=s(x,2),C=r(D),z=s(r(C),2);d(z),t(C);var $=s(C,2),G=s(r($),2);d(G),t($);var q=s($,2),I=s(r(q),2);d(I),t(q);var k=s(q,2),J=s(r(k),2);d(J),t(k);var K=s(k,2),Q=s(r(K),2);d(Q),t(K),t(D);var pe=s(D,4);{var ce=e=>{var o=xe(),n=r(o,!0);t(o),U(()=>Z(n,l(c))),O(e,o)};ee(pe,e=>{l(c)&&e(ce)})}t(A),t(P);var V=s(P,2),F=r(V),S=s(r(F),2),W=s(r(S),2);d(W),t(S);var N=s(S,2),X=s(r(N),2);d(X),t(N);var fe=s(N,4);{var ue=e=>{var o=De(),n=r(o,!0);t(o),U(()=>Z(n,l(m))),O(e,o)};ee(fe,e=>{l(m)&&e(ue)})}t(F),t(V),t(L),t(H),U(()=>he(M,"src",l(g)||"/default-profile.png")),R("change",ve,ne),v(z,()=>l(w),e=>a(w,e)),v(G,()=>l(b),e=>a(b,e)),v(I,()=>l(_),e=>a(_,e)),v(J,()=>l(h),e=>a(h,e)),v(Q,()=>l(j),e=>a(j,e)),R("submit",A,se(de)),v(W,()=>l(f),e=>a(f,e)),v(X,()=>l(u),e=>a(u,e)),R("submit",F,se(ie)),O(re,E),we(),oe()}export{Me as component};
