import"../chunks/DsnmJJEf.js";import"../chunks/DsPuBiMm.js";import{p as T,f as b,b as g,c as U,d as s,e as m,i as j,g as t,m as _,r as o,t as S,s as r}from"../chunks/N5lxWZGS.js";import{s as k}from"../chunks/B135_YsI.js";import{i as R}from"../chunks/DrWauV8B.js";import{c as z}from"../chunks/DCKGlpqt.js";import{r as B}from"../chunks/BnZ110ug.js";import{e as E}from"../chunks/Dx3h8YKD.js";import{b as G}from"../chunks/DnwoYYiD.js";import{i as H}from"../chunks/Bc0xGMnQ.js";import{C as K}from"../chunks/Bv3Pzr92.js";var L=b('<div class="error"> </div>'),Q=b('<div class="message"> </div>'),V=b('<div class="brand"><div class="logo">RAMS</div> <div class="title">Residence Access Management System</div></div> <div class="login-form"><h2>Forgot password</h2> <!> <!> <label>Username or email <input autocomplete="username"/></label> <button class="login-btn"> </button></div>',1),W=b('<section class="login-viewport svelte-3pr6iq"><div class="login-container svelte-3pr6iq"><!></div></section>');function ne(A,C){T(C,!1);let c=_(""),d=_(null),i=_(null),v=_(!1);async function M(){if(r(d,null),r(i,null),!t(c).trim()){r(i,"Please enter your username or email");return}r(v,!0);try{const l=new FormData;l.append("username",t(c).trim());const u=await fetch("/login/forgot",{method:"POST",body:l,credentials:"same-origin"}),n=await u.text().catch(()=>null);let p=null;if(n)try{p=JSON.parse(n)}catch{}if(!u.ok){r(i,p?.error||n||"Failed to request password reset");return}r(d,p?.message||n||"If that account exists, a reset email has been sent.")}catch(l){r(i,l?.message||"Network error")}finally{r(v,!1)}}H();var h=W(),q=s(h),O=s(q);z(O,()=>K,(l,u)=>{u(l,{className:"login-section",padding:"2.25rem",children:(n,p)=>{var x=V(),F=m(j(x),2),$=m(s(F),2);{var D=e=>{var a=L(),y=s(a,!0);o(a),S(()=>k(y,t(i))),g(e,a)};R($,e=>{t(i)&&e(D)})}var N=m($,2);{var I=e=>{var a=Q(),y=s(a,!0);o(a),S(()=>k(y,t(d))),g(e,a)};R(N,e=>{t(d)&&e(I)})}var w=m(N,2),P=m(s(w));B(P),o(w);var f=m(w,2),J=s(f,!0);o(f),o(F),S(()=>{f.disabled=t(v),k(J,t(v)?"Sending...":"Request reset")}),G(P,()=>t(c),e=>r(c,e)),E("click",f,M),g(n,x)},$$slots:{default:!0}})}),o(q),o(h),g(A,h),U()}export{ne as component};
